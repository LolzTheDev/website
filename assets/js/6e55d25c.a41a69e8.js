"use strict";(self.webpackChunk_sern_website=self.webpackChunk_sern_website||[]).push([[4752],{5788:(e,n,t)=>{t.d(n,{Iu:()=>p,yg:()=>g});var r=t(1504);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var o=r.createContext({}),c=function(e){var n=r.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(o.Provider,{value:n},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,o=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(t),d=i,g=u["".concat(o,".").concat(d)]||u[d]||m[d]||a;return t?r.createElement(g,l(l({ref:n},p),{},{components:t})):r.createElement(g,l({ref:n},p))}));function g(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,l=new Array(a);l[0]=d;var s={};for(var o in n)hasOwnProperty.call(n,o)&&(s[o]=n[o]);s.originalType=e,s[u]="string"==typeof e?e:i,l[1]=s;for(var c=2;c<a;c++)l[c]=t[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},2008:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>m,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var r=t(5072),i=(t(1504),t(5788));const a={},l=void 0,s={unversionedId:"cli/publish",id:"cli/publish",title:"publish",description:"Implicits",source:"@site/docs/cli/publish.md",sourceDirName:"cli",slug:"/cli/publish",permalink:"/docs/cli/publish",draft:!1,editUrl:"https://github.com/sern-handler/website/edit/main/docs/cli/publish.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"extra",permalink:"/docs/cli/extra"},next:{title:"Introduction",permalink:"/docs/guide/"}},o={},c=[{value:"Implicits",id:"implicits",level:2},{value:"Usage",id:"usage",level:2},{value:"Features",id:"features",level:2},{value:"Config",id:"config",level:2},{value:"Prerequiring",id:"prerequiring",level:2},{value:"Example: command published in guild",id:"example-command-published-in-guild",level:3},{value:"Script ran:",id:"script-ran",level:4}],p={toc:c},u="wrapper";function m(e){let{components:n,...a}=e;return(0,i.yg)(u,(0,r.c)({},p,a,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-sh"},"Usage: sern commands publish [options] [path]\n\nNew way to manage your slash commands\n\nArguments:\n  path                          path with respect to current working directory that will locate all published files\n\nOptions:\n  -i, --import [scriptPath...]  Prerequire a script to load into publisher\n  -t, --token [token]\n  --appId [applicationId]\n  -h, --help                    display help for command\n")),(0,i.yg)("h2",{id:"implicits"},"Implicits"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Automatically reads a .env in the working directory. For seamless integration, your .env file should look like this:")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-txt",metastring:'title=".env"',title:'".env"'},"DISCORD_TOKEN=<YOUR_TOKEN>\nAPPLICATION_ID=<YOUR_APPLICATION_ID>\nNODE_ENV=<production|development>\n")),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Calls the discord API with the ",(0,i.yg)("a",{parentName:"li",href:"https://discord.com/developers/docs/interactions/application-commands#bulk-overwrite-global-application-commands"},"PUT route"),". Wherever your commands directory is located, publish will override the existing application commands at Discord. Existing commands do not count towards the command limit creation daily. ")),(0,i.yg)("p",null,"You may pass these in as command line arguments as well. ",(0,i.yg)("strong",{parentName:"p"},"CLI arguments take precedence."),"\nIf you do not know how to obtain either of these credentials, ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/reactiflux/discord-irc/wiki/Creating-a-discord-bot-&-getting-a-token"},"click here")),(0,i.yg)("h2",{id:"usage"},"Usage"),(0,i.yg)("p",null,(0,i.yg)("img",{alt:"usage",src:t(736).c,width:"1171",height:"470"})),(0,i.yg)("h2",{id:"features"},"Features"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Automatically syncs api with your command base"),(0,i.yg)("li",{parentName:"ul"},"generates JSON file of output (",(0,i.yg)("strong",{parentName:"li"},".sern/command-data-remote.json"),")"),(0,i.yg)("li",{parentName:"ul"},"supports publishing direct esm typescript files"),(0,i.yg)("li",{parentName:"ul"},"commonjs + javascript users need to compile first and then run sern publish on the dist/ output"),(0,i.yg)("li",{parentName:"ul"},"prerequire scripts."),(0,i.yg)("li",{parentName:"ul"},"supports a configuration that is the same as the original publish plugin.")),(0,i.yg)("p",null,"Each command file can have an extra config that follows ",(0,i.yg)("inlineCode",{parentName:"p"},"ValidPublishOptions"),":"),(0,i.yg)("h2",{id:"config"},"Config"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-ts"},"\ntype ValidMemberPermissions = \n    | PermissionFlagBits  //discord.js enum\n    | PermissionFlagBits[]  //array of discord.js enum\n    | string //must be a stringified number\n    | bigint\n\ninterface PublishConfig {\n    guildIds?: string[];\n    dmPermission?: boolean;\n    defaultMemberPermissions: ValidMemberPermissions;\n}\ntype ValidPublishOptions = \n    | PublishConfig\n    | (absPath: string, module: CommandModule) => PublishConfig\n")),(0,i.yg)("p",null,"In other words, you can export a function or object."),(0,i.yg)("h2",{id:"prerequiring"},"Prerequiring"),(0,i.yg)("p",null,"Is there a ",(0,i.yg)("a",{parentName:"p",href:"../guide/walkthrough/services"},"service")," that is required at the top level of a command?"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Create an ES6 script anywhere: ")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-ts",metastring:'title="scripts/prerequire.mjs"',title:'"scripts/prerequire.mjs"'},"import { makeDependencies, single, Service } from '@sern/handler'\nimport { Client } from 'discord.js'\n\nawait makeDependencies({\n  build: (root) =>\n    root.add({ \"@sern/client\": single(() => new Client(...options)) }),\n});\n\nawait Service('@sern/client').login()\n")),(0,i.yg)("p",null,"This will create a container for publishing. (as of 0.6.0, client is required or this will crash)"),(0,i.yg)("h3",{id:"example-command-published-in-guild"},"Example: command published in guild"),(0,i.yg)("h4",{id:"script-ran"},"Script ran:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre"},"sern commands publish -i ./scripts/prerequire.mjs\n")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-ts",metastring:"title=src/commands/ping.ts",title:"src/commands/ping.ts"},"import { commandModule, Service, CommandType } from '@sern/handler'\n\nconst client = Service('@sern/client');\n\nexport const config = { \n    guildIds: [\"889026545715400705\"]\n}\n\nexport default commandModule( {\n    type: CommandType.Slash\n    description: `${client.user.username}'s ping`,\n    execute: (ctx) => { \n        ctx.reply('pong')\n    }\n})\n\n")))}m.isMDXComponent=!0},736:(e,n,t)=>{t.d(n,{c:()=>r});const r=t.p+"assets/images/Code_-_Insiders_2kTVzm0uIQ-76ace605cf3a0c5b7a55cb2c5228fcfa.gif"}}]);