"use strict";(self.webpackChunk_sern_website=self.webpackChunk_sern_website||[]).push([[3872],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=u(n),m=r,f=d["".concat(s,".").concat(m)]||d[m]||c[m]||l;return n?a.createElement(f,i(i({ref:t},p),{},{components:n})):a.createElement(f,i({ref:t},p))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,i=new Array(l);i[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[d]="string"==typeof e?e:r,i[1]=o;for(var u=2;u<l;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5162:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(7294),r=n(6010);const l={tabItem:"tabItem_Ymn6"};function i(e){let{children:t,hidden:n,className:i}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(l.tabItem,i),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>N});var a=n(7462),r=n(7294),l=n(6010),i=n(2466),o=n(6550),s=n(1980),u=n(7392),p=n(12);function d(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function c(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??d(n);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:n}=e;const a=(0,o.k6)(),l=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,s._X)(l),(0,r.useCallback)((e=>{if(!l)return;const t=new URLSearchParams(a.location.search);t.set(l,e),a.replace({...a.location,search:t.toString()})}),[l,a])]}function b(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,l=c(e),[i,o]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:l}))),[s,u]=f({queryString:n,groupId:a}),[d,b]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,l]=(0,p.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&l.set(e)}),[n,l])]}({groupId:a}),g=(()=>{const e=s??d;return m({value:e,tabValues:l})?e:null})();(0,r.useLayoutEffect)((()=>{g&&o(g)}),[g]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),b(e)}),[u,b,l]),tabValues:l}}var g=n(2389);const h={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function k(e){let{className:t,block:n,selectedValue:o,selectValue:s,tabValues:u}=e;const p=[],{blockElementScrollPositionUntilNextRender:d}=(0,i.o5)(),c=e=>{const t=e.currentTarget,n=p.indexOf(t),a=u[n].value;a!==o&&(d(t),s(a))},m=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=p.indexOf(e.currentTarget)+1;t=p[n]??p[0];break}case"ArrowLeft":{const n=p.indexOf(e.currentTarget)-1;t=p[n]??p[p.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":n},t)},u.map((e=>{let{value:t,label:n,attributes:i}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:o===t?0:-1,"aria-selected":o===t,key:t,ref:e=>p.push(e),onKeyDown:m,onClick:c},i,{className:(0,l.Z)("tabs__item",h.tabItem,i?.className,{"tabs__item--active":o===t})}),n??t)})))}function v(e){let{lazy:t,children:n,selectedValue:a}=e;const l=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=l.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},l.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function y(e){const t=b(e);return r.createElement("div",{className:(0,l.Z)("tabs-container",h.tabList)},r.createElement(k,(0,a.Z)({},e,t)),r.createElement(v,(0,a.Z)({},e,t)))}function N(e){const t=(0,g.Z)();return r.createElement(y,(0,a.Z)({key:String(t)},e))}},4489:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>f,frontMatter:()=>o,metadata:()=>u,toc:()=>d});var a=n(7462),r=(n(7294),n(3905)),l=n(4866),i=n(5162);const o={},s=void 0,u={unversionedId:"cli/build",id:"cli/build",title:"build",description:"Guiding Principles",source:"@site/docs/cli/build.md",sourceDirName:"cli",slug:"/cli/build",permalink:"/docs/cli/build",draft:!1,editUrl:"https://github.com/sern-handler/website/edit/main/docs/cli/build.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"CLI",permalink:"/docs/cli/"},next:{title:"clear",permalink:"/docs/cli/clear"}},p={},d=[{value:"Guiding Principles",id:"guiding-principles",level:2},{value:"Experimental Features",id:"experimental-features",level:2},{value:"Features",id:"features",level:2},{value:"Implicits",id:"implicits",level:2},{value:"sern.build.js",id:"sernbuildjs",level:3},{value:"Usage",id:"usage",level:2},{value:"Adapting older projects",id:"adapting-older-projects",level:2},{value:"In depth",id:"in-depth",level:2},{value:"drop labels",id:"drop-labels",level:3},{value:"constants",id:"constants",level:3},{value:"process.env",id:"processenv",level:3}],c={toc:d},m="wrapper";function f(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},'Usage: sern build [options]\n\nBuild your bot\n\nOptions:\n  -f --format [fmt]        The module system of your application. `cjs` or `esm` (default: "esm")\n  -m --mode [mode]         the mode for sern to build in. `production` or `development` (default: "development")\n  -W --suppress-warnings   suppress experimental warning\n  -p --project [filePath]  build with this sern.build file\n  -h, --help               display help for command\n')),(0,r.kt)("h2",{id:"guiding-principles"},"Guiding Principles"),(0,r.kt)("p",null,"When designing the ",(0,r.kt)("inlineCode",{parentName:"p"},"sern build")," command, our aim was to make building bot applications as simple as possible for the majority of developers. The setup process has been streamlined, and most of the configuration details have been handled for you. Here are some key points to keep in mind:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Minimal Configuration"),": In the vast majority (99%) of use cases, developers do not need to configure the bot application building process. We believe that simplicity is key, so only a few decisions need to be made on the developer's end.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Optimal Defaults"),": We've chosen sensible defaults. This means you can get started without getting bogged down by complex, unneeded configurations.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Finetuned for production bots"),": Our CLI leverages an opinionated build solution powered by esbuild. This ensures that bots are built without issues and can be shipped easily."))),(0,r.kt)("h2",{id:"experimental-features"},"Experimental Features"),(0,r.kt)("p",null,"Both the ",(0,r.kt)("inlineCode",{parentName:"p"},"sern build")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"sern publish")," commands are marked as experimental. While they might not be completely stable, they are designed to work for the majority of users. We appreciate any feedback in helping us make these features even better."),(0,r.kt)("h2",{id:"features"},"Features"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"sern build")," command comes equipped with a range of features designed to enhance your development process. Here's a glimpse of what it offers:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"esbuild Integration"),": our CLI takes inspiration from the efficiency of SvelteKit, ensuring your bot application is built effectively and with type safety. Leverage the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/esbuild/community-plugins"},"esbuild plugin ecosystem"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Zero Configuration"),": Building your bot application without additional configuration. The CLI handles most of the setup for you.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Experimental Image Support"),": We've introduced experimental support for top-level imports of PNG and JPG files, making it easier to include images in your bot application.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Compile Time Constants"),": Customize your build with constants such as ","_","_","DEV","_","_",", ","_","_","PROD","_","_",", allowing you to tailor your application to different production stages.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Development and Production Modes"),": The CLI supports both development and production modes, enabling you to tailor your bot application for different stages of development."))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Type-safe ",(0,r.kt)("inlineCode",{parentName:"strong"},"process.env")),": The CLI generates a type-safe ",(0,r.kt)("inlineCode",{parentName:"li"},"process.env"),", reducing potential errors.")),(0,r.kt)("h2",{id:"implicits"},"Implicits"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"command line arguments take precendence over sern.build configuration file"),(0,r.kt)("li",{parentName:"ul"},"default build format is ESM"),(0,r.kt)("li",{parentName:"ul"},"defineVersion = true"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"DEV")," AND ",(0,r.kt)("strong",{parentName:"li"},"PROD")," constants are configured. "),(0,r.kt)("li",{parentName:"ul"},"only a ",(0,r.kt)("a",{parentName:"li",href:"https://esbuild.github.io/content-types/#tsconfig-json"},"few tsconfig options")," are respected.")),(0,r.kt)("h3",{id:"sernbuildjs"},"sern.build.js"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"For any extra configuration you may need"),(0,r.kt)("li",{parentName:"ul"},"the cli was intentionally made to be installed globally, and we can't provide typings at a project level. If you need typings, here they are:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"type BuildOptions = {\n    /**\n      * Define __VERSION__\n      * This option is a quick switch to defining the __VERSION__ constant which will be a string of the version provided in \n      * cwd's package.json\n      */\n    defineVersion?: boolean \n    /**\n      * default = esm\n      */\n    format?: 'cjs' | 'esm'\n    /** \n      * extra esbuild plugins to build with sern.\n      */\n    esbuildPlugins?: esbuild.Plugin[]\n    /**\n     * https://esbuild.github.io/api/#drop-labels\n     **/\n    dropLabels?: string[]\n    /**\n     * https://esbuild.github.io/api/#define\n     **/\n    define?: Record<string, string>\n    /** \n    * Path to tsconfig\n    **/\n    tsconfig?: string;\n    /**\n      * default = 'development'\n      */\n    mode: 'production' | 'development',\n    /**\n      * will search for env file. If none exists, \n      * default to .env.\n      */\n    env?: string\n}\n")),(0,r.kt)("h2",{id:"usage"},"Usage"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"sern build\n")),(0,r.kt)("p",null,"(that was easy)"),(0,r.kt)("h2",{id:"adapting-older-projects"},"Adapting older projects"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Change your tsconfig.json to extend our generated one. ")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{ \n    // highlight-start\n    "extends": "./.sern/tsconfig.json",\n    // highlight-end\n    "compilerOptions" : {\n        //all of your old fields  \n    }\n}\n')),(0,r.kt)("h2",{id:"in-depth"},"In depth"),(0,r.kt)("p",null,"We use the ",(0,r.kt)("inlineCode",{parentName:"p"},"define")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"drop labels")," api in C style macros to have easy development stage differences.\n",(0,r.kt)("a",{parentName:"p",href:"https://esbuild.github.io/api/#drop-labels"},"Here")," is the esbuild full API documentation"),(0,r.kt)("h3",{id:"drop-labels"},"drop labels"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"# mode is set to production\nsern build\n")),(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"input",label:"Input",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"__DEV__: console.log('This is for production only')\n__PROD__: console.log('This is for either mode')\n"))),(0,r.kt)(i.Z,{value:"sh",label:"Running build for production",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"# mode is set to production\nsern build\n"))),(0,r.kt)(i.Z,{value:"output",label:"Output",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"__PROD__ console.log('This is for either mode')\n")))),(0,r.kt)("h3",{id:"constants"},"constants"),(0,r.kt)("p",null,"sern builds with three default constants. ","_","_","DEV","_","_",", ","_","_","PROD","_","_",", ","_","_","VERSION","_","_",". "),(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"input",label:"Preprocess",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"sern build\n"))),(0,r.kt)(i.Z,{value:"sh",label:"Constants available and typesafe!",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"if(__PROD__) {\n    console.log('Bot version: ' + __VERSION__)\n}\n")))),(0,r.kt)("p",null,"Full esbuild documentation ",(0,r.kt)("a",{parentName:"p",href:"https://esbuild.github.io/api/#define"},"here"),"\nAdd more to the ",(0,r.kt)("inlineCode",{parentName:"p"},"define")," field in build options (only availible with a ",(0,r.kt)("inlineCode",{parentName:"p"},"sern.build")," file at the moment."),(0,r.kt)("h3",{id:"processenv"},"process.env"),(0,r.kt)("p",null,"We generate your process.env with ",(0,r.kt)("inlineCode",{parentName:"p"},"dotenv")," and generate typings for process.env. Less hassle!"),(0,r.kt)(l.Z,{mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"input",label:".env",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"DISCORD_TOKEN=<your token>\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"process.env.DISCORD_TOKEN // string | undefined (not typesafe :()\n"))),(0,r.kt)(i.Z,{value:"sh",label:"sern build",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"sern build\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"process.env.DISCORD_TOKEN // string  (typesafe :))\n")))))}f.isMDXComponent=!0}}]);